# frontend/Dockerfile
FROM node:16

WORKDIR /code

COPY package.json package-lock.json ./

RUN npm install

COPY . .

ARG NEXT_PUBLIC_BACKEND_BASE_URL
ENV NEXT_PUBLIC_BACKEND_BASE_URL=${NEXT_PUBLIC_BACKEND_BASE_URL}
ARG NEXT_PUBLIC_FRONTEND_BASE_URL
ENV NEXT_PUBLIC_FRONTEND_BASE_URL=${NEXT_PUBLIC_FRONTEND_BASE_URL}
ARG SERVER_SIDE_BACKEND_BASE_URL
ENV SERVER_SIDE_BACKEND_BASE_URL=${SERVER_SIDE_BACKEND_BASE_URL}
ARG NODE_TLS_REJECT_UNAUTHORIZED
ENV NODE_TLS_REJECT_UNAUTHORIZED=${NODE_TLS_REJECT_UNAUTHORIZED}
ARG NEXT_PUBLIC_FRONTEND_BASE_HTTP_URL
ENV NEXT_PUBLIC_FRONTEND_BASE_HTTP_URL=${NEXT_PUBLIC_FRONTEND_BASE_HTTP_URL}

RUN npm run build

CMD ["npm", "start"]

EXPOSE 80
